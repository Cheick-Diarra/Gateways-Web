<link rel="import" href="../libraries/polymer/polymer.html">
<link rel="import" href="../libraries/iron-form/iron-form.html">
<link rel="import" href="../libraries/paper-input/paper-input.html">
<link rel="import" href="../libraries/paper-button/paper-button.html">
<link rel="import" href="../libraries/paper-toast/paper-toast.html">
<link rel="import" href="../libraries/iron-ajax/iron-ajax.html"/>
<dom-module id="login-form">

  <style>
    #main
    {
        min-width:300px;
        padding:10px;
    }
  </style>
  
  <template>
  
    <iron-ajax
      id="loginAjax"
      url="../services/login.php"
      method="POST"
      handle-as="json"
      on-response = "loginResponseReceived"
      on-error = "onErrorReceived">
    </iron-ajax>
    
    <div id="main">
        <form is="iron-form" id="form" method="post" action="#">
          <paper-input id="email" name="email" label="Email Id" type="email" auto-validate></paper-input>
          <paper-input id="password" name="password" label="password" type="password"></paper-input>
          <!--<br><paper-button id="loginButton" on-click="submit">Register</paper-button>
          <paper-toast id="toast" text="Email or Password is incorrect"></paper-toast>-->
        </form>
    </div>
  </template>
  
  <script>
    Polymer({
      is : 'login-form',
      
     // collegeSelected: Number,
      
      properties : {
        
      },
      
    loginResponseReceived : function () {
        var response = this.$.loginAjax.lastResponse;
        console.log("Response by login" , response);
        if(response.status==="true")
        {
            info("Logged in");
            //Redirect to page
        }
        else
            info("Login unsuccessful");
    },
    
    onErrorReceived : function () {
        var response = this.$.loginAjax.lastError;
        console.log("Response by error: " , response.error.message);
        info(response.error.message);
    },
    
    submit : function () {
        var email = this.$.email.value;
        var password = this.$.password.value;
        
        if(this.$.email.invalid)
            console.log("Invalid");
        else 
        {
            console.log("Valid");
            
            console.log("Register id" , email);
            console.log("Register password" , password);
            
            var params = {};
            params.email = email;
            params.password = password;
            console.log(params);
            var ajax = this.$.loginAjax;
            ajax.params = params;
            ajax.generateRequest();
        }
      }
    });
  </script>
</dom-module>