<link rel="import" href="../libraries/polymer/polymer.html">
<link rel="import" href="../libraries/iron-flex-layout/classes/iron-flex-layout.html">
<link rel="import" href="../libraries/paper-fab/paper-fab.html">

<dom-module id="timeline-events">

  <style>
    div.timeline {
      width : 100%;
      height: 70px;
      background-color: #ecf0f1;
    }

    #dot-container > ::content paper-fab {
      color:#34495e;
      background: white;

    }

    #dot-container > ::content paper-fab :hover {
      color:#fde3a7;
    }


  </style>

  <template>
    <div class="timeline vertical layout">

        <div class="flex"></div>
        <div id="dot-container" class="horizontal layout">
          <div  class="flex"></div>
          <content></content>
          <div  class="flex"></div>
        </div>
        <div  class="flex"></div>

    </div>
  </template>

  <script>
    Polymer({

      is : 'timeline-events',

      milestones : [],
      lastSelected:{},

      properties : {
        selected : {
          type : Number,
          notify : true
        }
      },

      ready : function () {

        var host = this;
        var content = this.$$('content');
        var distributed = Polymer.dom(content).getDistributedNodes();
        this.milestones = distributed;
        var dotCounter = 0;

        for ( var i = 0 ; i < distributed.length ; i++) {
          if(this.hasClass(distributed[i] , 'dot' )) {

            distributed[i].eventIndex = dotCounter;
            distributed[i].elementIndex = i;
            distributed[i].addEventListener('mouseover' , function() {
              host._onHoverEvent(i , event);
            });

            distributed[i].addEventListener('click' , function() {
              host._onClickEvent(this.eventIndex, this.elementIndex , event);
            });
            dotCounter++;
          }
        }
      },

      _onHoverEvent : function (index , event) {
          console.log("hover" , event.clientX);
      },

      _onClickEvent : function (selectedIndex, elementIndex , event) {
        console.log("index" , selectedIndex);
        this.selected = selectedIndex;
        if(this.lastSelected != undefined)
          this.lastSelected.active = false;

          this.lastSelected = this.milestones[elementIndex];
      },

      hasClass : function (element, cls) {
          return (' ' + element.className + ' ').indexOf(' ' + cls + ' ') > -1;
      }
    });
  </script>

</dom-module>
